# üìã –≠–¢–ê–ü 5: FREQUI INTEGRATION
# Freqtrade Multi-Bot System - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Freqtrade

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 4 —á–∞—Å–∞
**–¶–µ–ª—å:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è FreqUI (Frequi) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Freqtrade –±–æ—Ç–∞–º–∏

---

## üéØ –ó–ê–î–ê–ß–ò –≠–¢–ê–ü–ê

### ‚úÖ –ó–∞–¥–∞—á–∞ 5.1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ FreqUI (1.5 —á–∞—Å–∞)
- –°–∫–∞—á–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å FreqUI –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Freqtrade RPC API
- –ó–∞–ø—É—Å—Ç–∏—Ç—å FreqUI –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

### ‚úÖ –ó–∞–¥–∞—á–∞ 5.2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Multi-Bot —Å–∏—Å—Ç–µ–º–æ–π (1.5 —á–∞—Å–∞)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ —Ä–∞–∑–Ω—ã–º Freqtrade –∏–Ω—Å—Ç–∞–Ω—Å–∞–º
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏
- –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è multi-bot —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ –ó–∞–¥–∞—á–∞ 5.3: –õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (1 —á–∞—Å)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ FreqUI –∫ –ª–æ–∫–∞–ª—å–Ω—ã–º Freqtrade –∏–Ω—Å—Ç–∞–Ω—Å–∞–º
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å multi-bot –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π

---

## üöÄ –î–ï–¢–ê–õ–¨–ù–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ FreqUI (1.5 —á–∞—Å–∞)

#### –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ FreqUI
**FreqUI** - —ç—Ç–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è Freqtrade, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ [freqtrade/frequi](https://github.com/freqtrade/frequi).

```bash
# –°–∫–∞—á–∞—Ç—å FreqUI
git clone https://github.com/freqtrade/frequi.git
cd frequi

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é Node.js (—Ç—Ä–µ–±—É–µ—Ç—Å—è 16+)
node --version

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –°–æ–±—Ä–∞—Ç—å –¥–ª—è production
npm run build

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ FreqUI –ø—Ä–æ–µ–∫—Ç–∞:
```
frequi/
‚îú‚îÄ‚îÄ public/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/     # Vue.js –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ views/         # –°—Ç—Ä–∞–Ω–∏—Ü—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ store/         # Vuex store
‚îÇ   ‚îú‚îÄ‚îÄ router/        # Vue Router
‚îÇ   ‚îî‚îÄ‚îÄ plugins/       # –ü–ª–∞–≥–∏–Ω—ã
‚îú‚îÄ‚îÄ dist/              # –°–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–ø–æ—Å–ª–µ npm run build)
‚îú‚îÄ‚îÄ docker/            # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ docker-compose.yml # Docker Compose –¥–ª—è FreqUI
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Freqtrade

FreqUI –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Freqtrade —á–µ—Ä–µ–∑ RPC API. –î–ª—è multi-bot —Å–∏—Å—Ç–µ–º—ã –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è FreqUI –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–æ—Ç–æ–≤:**
```javascript
// src/config/freqtrade.js
export const freqtradeConfigs = {
  bot1: {
    name: 'BTC/USDT Bot',
    url: 'http://localhost:8080',  // Freqtrade RPC –¥–ª—è –±–æ—Ç–∞ 1
    username: 'freqtrade',
    password: 'supersecurepassword'
  },
  bot2: {
    name: 'ETH/USDT Bot',
    url: 'http://localhost:8081',  // Freqtrade RPC –¥–ª—è –±–æ—Ç–∞ 2
    username: 'freqtrade',
    password: 'supersecurepassword'
  },
  bot3: {
    name: 'ADA/USDT Bot',
    url: 'http://localhost:8082',  // Freqtrade RPC –¥–ª—è –±–æ—Ç–∞ 3
    username: 'freqtrade',
    password: 'supersecurepassword'
  }
}

export default freqtradeConfigs
```

### 2. –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è FreqUI –¥–ª—è Multi-Bot —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1.5 —á–∞—Å–∞)

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è –±–æ—Ç–æ–≤
**src/components/BotSwitcher.vue:**
```vue
<template>
  <v-select
    v-model="selectedBot"
    :items="availableBots"
    label="Select Trading Bot"
    item-title="name"
    item-value="id"
    @update:model-value="onBotChange"
    class="bot-switcher"
  >
    <template v-slot:item="{ props, item }">
      <v-list-item v-bind="props">
        <v-list-item-title>{{ item.raw.name }}</v-list-item-title>
        <v-list-item-subtitle>
          <v-chip
            :color="getStatusColor(item.raw.status)"
            size="small"
            variant="flat"
          >
            {{ item.raw.status }}
          </v-chip>
        </v-list-item-subtitle>
      </v-list-item>
    </template>
  </v-select>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'
import { useStore } from 'vuex'

const store = useStore()
const selectedBot = ref(null)

const availableBots = computed(() => [
  { id: 'bot1', name: 'BTC/USDT Bot', status: 'running' },
  { id: 'bot2', name: 'ETH/USDT Bot', status: 'stopped' },
  { id: 'bot3', name: 'ADA/USDT Bot', status: 'running' }
])

const onBotChange = (botId: string) => {
  // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ FreqUI –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –±–æ—Ç—É
  store.dispatch('switchBot', botId)
}

const getStatusColor = (status: string) => {
  switch (status) {
    case 'running': return 'success'
    case 'stopped': return 'error'
    case 'error': return 'warning'
    default: return 'grey'
  }
}

onMounted(() => {
  // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–æ—Ç–æ–≤
  store.dispatch('loadBots')
})
</script>

<style scoped>
.bot-switcher {
  max-width: 300px;
}
</style>
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Multi-Bot API
**src/store/modules/bots.js:**
```javascript
// Vuex store module for multi-bot management
export default {
  namespaced: true,

  state: () => ({
    currentBot: null,
    availableBots: [],
    botConfigs: {}
  }),

  mutations: {
    SET_CURRENT_BOT(state, botId) {
      state.currentBot = botId
    },

    SET_AVAILABLE_BOTS(state, bots) {
      state.availableBots = bots
    },

    SET_BOT_CONFIG(state, { botId, config }) {
      state.botConfigs[botId] = config
    }
  },

  actions: {
    async loadBots({ commit }) {
      try {
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –±–æ—Ç–æ–≤ –∏–∑ –Ω–∞—à–µ–≥–æ Multi-Bot API
        const response = await fetch('/api/v1/bots')
        const bots = await response.json()
        commit('SET_AVAILABLE_BOTS', bots.bots)
      } catch (error) {
        console.error('Failed to load bots:', error)
      }
    },

    async switchBot({ commit, dispatch }, botId) {
      commit('SET_CURRENT_BOT', botId)

      // –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é FreqUI –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –±–æ—Ç—É
      const botConfig = await dispatch('getBotConfig', botId)
      dispatch('updateFreqUIConfig', botConfig)
    },

    async getBotConfig({ state }, botId) {
      // –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Freqtrade –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–æ—Ç–∞
      const response = await fetch(`/api/v1/bots/${botId}/config`)
      return await response.json()
    },

    updateFreqUIConfig({ state }, config) {
      // –û–±–Ω–æ–≤–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é FreqUI
      window.freqtradeConfig = {
        url: config.freqtrade_rpc_url,
        username: config.username,
        password: config.password
      }
    }
  }
}
```

### 3. –õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è FreqUI (1 —á–∞—Å)

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Freqtrade –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
–î–ª—è multi-bot —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ Freqtrade –±–æ—Ç–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ä—Ç–∞—Ö:

```bash
# –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞
mkdir freqtrade_bots
cd freqtrade_bots

# –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è BTC/USDT –±–æ—Ç–∞
cat > config_btc.json << 'EOF'
{
    "max_open_trades": 3,
    "stake_currency": "USDT",
    "stake_amount": 100,
    "fiat_display_currency": "USD",
    "timeframe": "5m",
    "dry_run": false,
    "cancel_open_orders_on_exit": false,
    "exchange": {
        "name": "binance",
        "key": "${BINANCE_API_KEY}",
        "secret": "${BINANCE_API_SECRET}",
        "ccxt_config": {},
        "ccxt_async_config": {},
        "pair_whitelist": ["BTC/USDT"],
        "pair_blacklist": []
    },
    "pairlists": [
        {"method": "StaticPairList"}
    ],
    "rpc": {
        "enabled": true,
        "host": "127.0.0.1",
        "port": 8080,
        "username": "freqtrade",
        "password": "supersecurepassword"
    }
}
EOF

# –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è ETH/USDT –±–æ—Ç–∞
cat > config_eth.json << 'EOF'
{
    "max_open_trades": 2,
    "stake_currency": "USDT",
    "stake_amount": 50,
    "fiat_display_currency": "USD",
    "timeframe": "5m",
    "dry_run": false,
    "cancel_open_orders_on_exit": false,
    "exchange": {
        "name": "binance",
        "key": "${BINANCE_API_KEY}",
        "secret": "${BINANCE_API_SECRET}",
        "ccxt_config": {},
        "ccxt_async_config": {},
        "pair_whitelist": ["ETH/USDT"],
        "pair_blacklist": []
    },
    "pairlists": [
        {"method": "StaticPairList"}
    ],
    "rpc": {
        "enabled": true,
        "host": "127.0.0.1",
        "port": 8081,
        "username": "freqtrade",
        "password": "supersecurepassword"
    }
}
EOF
```

#### –ó–∞–ø—É—Å–∫ Freqtrade –±–æ—Ç–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ
```bash
# –í –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–æ–≤
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: BTC/USDT –±–æ—Ç
freqtrade trade --config config_btc.json --strategy SimpleTestStrategy

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: ETH/USDT –±–æ—Ç
freqtrade trade --config config_eth.json --strategy AggressiveStrategy

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã RPC API
curl http://localhost:8080/api/v1/status
curl http://localhost:8081/api/v1/status
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ FreqUI –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏
**src/config/bots.js:**
```javascript
// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ —Ä–∞–∑–Ω—ã–º Freqtrade –±–æ—Ç–∞–º
export const botConfigs = {
  btc_bot: {
    id: 'btc_bot',
    name: 'BTC/USDT Bot',
    freqtradeUrl: 'http://localhost:8080',
    username: 'freqtrade',
    password: 'supersecurepassword',
    strategy: 'SimpleTestStrategy',
    pairs: ['BTC/USDT']
  },
  eth_bot: {
    id: 'eth_bot',
    name: 'ETH/USDT Bot',
    freqtradeUrl: 'http://localhost:8081',
    username: 'freqtrade',
    password: 'supersecurepassword',
    strategy: 'AggressiveStrategy',
    pairs: ['ETH/USDT']
  }
}

export default botConfigs
```

#### –ó–∞–ø—É—Å–∫ FreqUI –ª–æ–∫–∞–ª—å–Ω–æ
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å FreqUI –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
cd frequi
npm run dev

# –ò–ª–∏ —Å–æ–±—Ä–∞—Ç—å –¥–ª—è production
npm run build
npm run serve

# FreqUI –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:3000
# –î–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ URL:
# http://localhost:3000/?url=http://localhost:8080
# http://localhost:3000/?url=http://localhost:8081
```

**src/components/BotCard.vue:**
```vue
<template>
  <v-card class="bot-card" :class="{ 'active': bot.is_active }">
    <v-card-title class="d-flex align-center pb-2">
      <v-avatar size="40" class="me-3">
        <v-icon>{{ bot.strategy_icon || 'mdi-robot' }}</v-icon>
      </v-avatar>
      <div class="flex-grow-1">
        <div class="text-h6">{{ bot.name }}</div>
        <div class="text-caption text-medium-emphasis">{{ bot.strategy }}</div>
      </div>
      <v-chip
        :color="bot.status === 'running' ? 'success' : 'grey'"
        size="small"
        variant="flat"
      >
        {{ bot.status }}
      </v-chip>
    </v-card-title>

    <v-card-text class="pt-0">
      <v-row dense>
        <v-col cols="6">
          <div class="text-caption">Profit</div>
          <div
            class="text-h6"
            :class="bot.profit >= 0 ? 'text-success' : 'text-error'"
          >
            {{ formatPercent(bot.profit) }}
          </div>
        </v-col>
        <v-col cols="6">
          <div class="text-caption">Trades</div>
          <div class="text-h6">{{ bot.total_trades }}</div>
        </v-col>
      </v-row>

      <v-row dense class="mt-2">
        <v-col cols="6">
          <div class="text-caption">Active Trades</div>
          <div class="text-h6">{{ bot.active_trades }}</div>
        </v-col>
        <v-col cols="6">
          <div class="text-caption">Uptime</div>
          <div class="text-h6">{{ formatDuration(bot.uptime) }}</div>
        </v-col>
      </v-row>
    </v-card-text>

    <v-card-actions class="pt-0">
      <v-btn
        size="small"
        variant="text"
        color="primary"
        @click="$emit('view-details', bot)"
      >
        Details
      </v-btn>
      <v-spacer></v-spacer>
      <v-btn
        size="small"
        :color="bot.is_active ? 'warning' : 'success'"
        variant="flat"
        @click="toggleBot"
        :loading="loading"
      >
        {{ bot.is_active ? 'Stop' : 'Start' }}
      </v-btn>
    </v-card-actions>
  </v-card>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { useApi } from '@/composables/useApi'
import { useToast } from 'vue-toastification'

interface Props {
  bot: {
    id: string
    name: string
    strategy: string
    strategy_icon?: string
    status: string
    is_active: boolean
    profit: number
    total_trades: number
    active_trades: number
    uptime: number
  }
}

const props = defineProps<Props>()
const emit = defineEmits<{
  'view-details': [bot: Props['bot']]
  'status-changed': [bot: Props['bot']]
}>()

const { api } = useApi()
const toast = useToast()
const loading = ref(false)

const toggleBot = async () => {
  loading.value = true
  try {
    if (props.bot.is_active) {
      await api.stopBot(props.bot.id)
      toast.success(`Bot ${props.bot.name} stopped`)
    } else {
      await api.startBot(props.bot.id, {})
      toast.success(`Bot ${props.bot.name} started`)
    }
    emit('status-changed', props.bot)
  } catch (error) {
    toast.error('Failed to toggle bot status')
    console.error(error)
  } finally {
    loading.value = false
  }
}

const formatPercent = (value: number) => {
  return `${value >= 0 ? '+' : ''}${value.toFixed(2)}%`
}

const formatDuration = (seconds: number) => {
  const hours = Math.floor(seconds / 3600)
  const minutes = Math.floor((seconds % 3600) / 60)
  return `${hours}h ${minutes}m`
}
</script>

<style scoped>
.bot-card.active {
  border-left: 4px solid rgb(var(--v-theme-success));
}
</style>
```

### 4. Chart Component with ApexCharts (1 —á–∞—Å)
**src/components/MarketChart.vue:**
```vue
<template>
  <div ref="chartContainer" :style="{ height: height + 'px' }"></div>
</template>

<script setup lang="ts">
import { ref, onMounted, onUnmounted, watch } from 'vue'
import ApexCharts from 'apexcharts'
import { useApi } from '@/composables/useApi'
import { useWebSocket } from '@/composables/useWebSocket'

interface Props {
  pair?: string
  timeframe?: string
  height?: number
}

const props = withDefaults(defineProps<Props>(), {
  pair: 'BTC/USDT',
  timeframe: '5m',
  height: 400
})

const { api } = useApi()
const { socket } = useWebSocket()
const chartContainer = ref<HTMLElement>()
const chart = ref<ApexCharts | null>(null)
const chartData = ref<any[]>([])

const chartOptions = {
  chart: {
    type: 'candlestick',
    height: props.height,
    background: 'transparent',
    toolbar: {
      show: true,
      tools: {
        download: true,
        selection: true,
        zoom: true,
        zoomin: true,
        zoomout: true,
        pan: true,
        reset: true
      }
    },
    animations: {
      enabled: true,
      easing: 'easeinout',
      speed: 800,
      animateGradually: {
        enabled: true,
        delay: 150
      },
      dynamicAnimation: {
        enabled: true,
        speed: 350
      }
    }
  },
  title: {
    text: `${props.pair} - ${props.timeframe}`,
    align: 'left',
    style: {
      color: '#ffffff'
    }
  },
  xaxis: {
    type: 'datetime',
    labels: {
      style: {
        colors: '#ffffff'
      }
    }
  },
  yaxis: {
    labels: {
      style: {
        colors: '#ffffff'
      }
    }
  },
  plotOptions: {
    candlestick: {
      colors: {
        upward: '#00C853',
        downward: '#FF1744'
      }
    }
  },
  theme: {
    mode: 'dark'
  },
  grid: {
    borderColor: '#334155'
  },
  tooltip: {
    theme: 'dark'
  }
}

const loadChartData = async () => {
  try {
    const data = await api.getMarketData(props.pair, props.timeframe, 200)
    chartData.value = data.map((item: any) => ({
      x: new Date(item.timestamp),
      y: [item.open, item.high, item.low, item.close]
    }))
    updateChart()
  } catch (error) {
    console.error('Failed to load chart data:', error)
  }
}

const updateChart = () => {
  if (chart.value && chartData.value.length > 0) {
    chart.value.updateSeries([{
      data: chartData.value
    }])
  }
}

const initializeChart = () => {
  if (chartContainer.value) {
    chart.value = new ApexCharts(chartContainer.value, {
      ...chartOptions,
      series: [{
        data: chartData.value
      }]
    })
    chart.value.render()
  }
}

const handleWebSocketUpdate = (data: any) => {
  if (data.pair === props.pair) {
    // Update chart with new data
    const newCandle = {
      x: new Date(data.timestamp),
      y: [data.open, data.high, data.low, data.close]
    }

    chartData.value.push(newCandle)
    if (chartData.value.length > 200) {
      chartData.value.shift()
    }

    updateChart()
  }
}

onMounted(async () => {
  await loadChartData()
  initializeChart()

  // Listen for WebSocket updates
  if (socket.value) {
    socket.value.on('market_data_update', handleWebSocketUpdate)
  }
})

onUnmounted(() => {
  if (chart.value) {
    chart.value.destroy()
  }
  if (socket.value) {
    socket.value.off('market_data_update', handleWebSocketUpdate)
  }
})

watch(() => props.pair, async () => {
  await loadChartData()
})

watch(() => props.timeframe, async () => {
  await loadChartData()
})
</script>
```

### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Å–±–æ—Ä–∫–∞:

#### vite.config.ts:
```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { fileURLToPath, URL } from 'node:url'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url))
    }
  },
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true,
        secure: false
      }
    }
  },
  build: {
    outDir: '../static/dist',
    emptyOutDir: true
  }
})
```

#### src/types/index.ts:
```typescript
export interface Bot {
  id: string
  name: string
  strategy: string
  status: 'running' | 'stopped' | 'error'
  is_active: boolean
  profit: number
  total_trades: number
  active_trades: number
  uptime: number
  config: BotConfig
}

export interface BotConfig {
  stake_amount: number
  max_open_trades: number
  timeframe: string
  pairs: string[]
  strategy_parameters: Record<string, any>
}

export interface Trade {
  id: string
  pair: string
  side: 'buy' | 'sell'
  amount: number
  price: number
  timestamp: string
  profit?: number
  fee: number
}

export interface Portfolio {
  total_value: number
  available_balance: number
  positions: Position[]
  performance: PerformanceMetrics
}

export interface Position {
  pair: string
  amount: number
  value: number
  pnl: number
  pnl_percent: number
}

export interface PerformanceMetrics {
  total_return: number
  win_rate: number
  max_drawdown: number
  sharpe_ratio: number
  total_trades: number
}

export interface MarketData {
  timestamp: string
  open: number
  high: number
  low: number
  close: number
  volume: number
}

export interface Notification {
  id: string
  type: 'info' | 'success' | 'warning' | 'error'
  title: string
  message: string
  timestamp: string
  read: boolean
}
```

### ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–∞–ø–∞:

#### tests/e2e/test_frontend.py:
```python
import pytest
from playwright.sync_api import Page, expect

class TestFrontend:
    def test_dashboard_loads(self, page: Page):
        """Test that dashboard loads correctly."""
        page.goto("http://localhost:3000")

        # Check page title
        expect(page).to_have_title("Freqtrade Multi-Bot Dashboard")

        # Check main elements are present
        expect(page.locator("text=Trading Dashboard")).to_be_visible()
        expect(page.locator("text=Portfolio Overview")).to_be_visible()
        expect(page.locator("text=Bot Management")).to_be_visible()

    def test_bot_management(self, page: Page):
        """Test bot management functionality."""
        page.goto("http://localhost:3000")

        # Navigate to bot management
        page.click("text=Bot Management")

        # Check bot list is loaded
        expect(page.locator(".bot-card")).to_have_count_greater_than(0)

        # Test creating a new bot
        page.click("text=Add Bot")
        page.fill("[placeholder='Bot Name']", "Test Bot")
        page.select_option("select[name='strategy']", "SimpleStrategy")
        page.click("text=Create Bot")

        # Check bot was created
        expect(page.locator("text=Test Bot")).to_be_visible()

    def test_trading_interface(self, page: Page):
        """Test trading interface functionality."""
        page.goto("http://localhost:3000/trading")

        # Check chart is loaded
        expect(page.locator(".apexcharts-canvas")).to_be_visible()

        # Check trading controls
        expect(page.locator("text=Buy")).to_be_visible()
        expect(page.locator("text=Sell")).to_be_visible()

    def test_real_time_updates(self, page: Page):
        """Test real-time updates via WebSocket."""
        page.goto("http://localhost:3000")

        # Wait for WebSocket connection
        page.wait_for_function("window.wsConnected === true")

        # Check that status indicator shows connected
        expect(page.locator("text=Connected")).to_be_visible()

    def test_responsive_design(self, page: Page):
        """Test responsive design on different screen sizes."""
        page.goto("http://localhost:3000")

        # Test mobile view
        page.set_viewport_size({"width": 375, "height": 667})
        expect(page.locator(".mobile-menu")).to_be_visible()

        # Test tablet view
        page.set_viewport_size({"width": 768, "height": 1024})
        expect(page.locator(".tablet-layout")).to_be_visible()

        # Test desktop view
        page.set_viewport_size({"width": 1920, "height": 1080})
        expect(page.locator(".desktop-layout")).to_be_visible()

    def test_error_handling(self, page: Page):
        """Test error handling in frontend."""
        # Simulate API error
        page.route("**/api/bots", lambda route: route.fulfill(status=500))

        page.goto("http://localhost:3000")

        # Check error message is displayed
        expect(page.locator("text=Server error")).to_be_visible()
```

### üìä –ö–†–ò–¢–ï–†–ò–ò –ì–û–¢–û–í–ù–û–°–¢–ò –≠–¢–ê–ü–ê 5

### ‚úÖ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- [x] Vue.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å TypeScript –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- [x] API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å axios —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- [x] ApexCharts –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- [x] Responsive –¥–∏–∑–∞–π–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

### ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- [x] FreqUI —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- [x] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Freqtrade RPC API —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- [x] –í—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ FreqUI –¥–æ—Å—Ç—É–ø–Ω—ã
- [x] Multi-bot —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –Ω–∞—à API –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

**–ü–µ—Ä–µ—Ö–æ–¥ –∫ –≠—Ç–∞–ø—É 6:** [Infrastructure - Docker & Deployment](06_infrastructure.md)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º:**
```bash
# –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
cd frequi && npm run lint
cd frequi && npm run build

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Freqtrade –±–æ—Ç–∞–º
curl http://localhost:8080/api/v1/status
curl http://localhost:8081/api/v1/status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É FreqUI
curl http://localhost:3000
```

---

*–≠—Ç–∞–ø 5 –∑–∞–≤–µ—Ä—à–µ–Ω: Vue.js –¥–∞—à–±–æ—Ä–¥ —Å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –≥–æ—Ç–æ–≤*